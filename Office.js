var OSFPerformance;
(function (OSFPerformance) {
    OSFPerformance.officeExecuteStart = 0;
    OSFPerformance.officeExecuteEnd = 0;
    OSFPerformance.hostInitializationStart = 0;
    OSFPerformance.hostInitializationEnd = 0;
    OSFPerformance.createOMEnd = 0;
    OSFPerformance.hostSpecificFileName = "";
    function now() {
        if (performance && performance.now) {
            return performance.now();
        }
        else {
            return 0;
        }
    }
    OSFPerformance.now = now;
})(OSFPerformance || (OSFPerformance = {}));
;
OSFPerformance.officeExecuteStart = OSFPerformance.now();



/* Office JavaScript API library */

/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/


/*
    Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.

    This file also contains the following Promise implementation (with a few small modifications):
        * @overview es6-promise - a tiny implementation of Promises/A+.
        * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
        * @license   Licensed under MIT license
        *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
        * @version   2.3.0
*/
var OSF = OSF || {}; OSF.HostSpecificFileVersionDefault = "16.00"; OSF.HostSpecificFileVersionMap = { access: { web: "16.00" }, agavito: { winrt: "16.00" }, excel: { ios: "16.00", mac: "16.00", web: "16.00", win32: "16.01", winrt: "16.00" }, onenote: { android: "16.00", web: "16.00", win32: "16.00", winrt: "16.00" }, outlook: { ios: "16.00", mac: "16.00", web: "16.01", win32: "16.02" }, powerpoint: { ios: "16.00", mac: "16.00", web: "16.00", win32: "16.01", winrt: "16.00" }, project: { win32: "16.00" }, sway: { web: "16.00" }, word: { ios: "16.00", mac: "16.00", web: "16.00", win32: "16.01", winrt: "16.00" }, visio: { web: "16.00", win32: "16.00" } }; OSF.SupportedLocales = { "ar-sa": true, "bg-bg": true, "bn-in": true, "ca-es": true, "cs-cz": true, "da-dk": true, "de-de": true, "el-gr": true, "en-us": true, "es-es": true, "et-ee": true, "eu-es": true, "fa-ir": true, "fi-fi": true, "fr-fr": true, "gl-es": true, "he-il": true, "hi-in": true, "hr-hr": true, "hu-hu": true, "id-id": true, "it-it": true, "ja-jp": true, "kk-kz": true, "ko-kr": true, "lo-la": true, "lt-lt": true, "lv-lv": true, "ms-my": true, "nb-no": true, "nl-nl": true, "nn-no": true, "pl-pl": true, "pt-br": true, "pt-pt": true, "ro-ro": true, "ru-ru": true, "sk-sk": true, "sl-si": true, "sr-cyrl-cs": true, "sr-cyrl-rs": true, "sr-latn-cs": true, "sr-latn-rs": true, "sv-se": true, "th-th": true, "tr-tr": true, "uk-ua": true, "ur-pk": true, "vi-vn": true, "zh-cn": true, "zh-tw": true }; OSF.AssociatedLocales = { ar: "ar-sa", bg: "bg-bg", bn: "bn-in", ca: "ca-es", cs: "cs-cz", da: "da-dk", de: "de-de", el: "el-gr", en: "en-us", es: "es-es", et: "et-ee", eu: "eu-es", fa: "fa-ir", fi: "fi-fi", fr: "fr-fr", gl: "gl-es", he: "he-il", hi: "hi-in", hr: "hr-hr", hu: "hu-hu", id: "id-id", it: "it-it", ja: "ja-jp", kk: "kk-kz", ko: "ko-kr", lo: "lo-la", lt: "lt-lt", lv: "lv-lv", ms: "ms-my", nb: "nb-no", nl: "nl-nl", nn: "nn-no", pl: "pl-pl", pt: "pt-br", ro: "ro-ro", ru: "ru-ru", sk: "sk-sk", sl: "sl-si", sr: "sr-cyrl-cs", sv: "sv-se", th: "th-th", tr: "tr-tr", uk: "uk-ua", ur: "ur-pk", vi: "vi-vn", zh: "zh-cn" }; OSF.getSupportedLocale = function (a, c) { if (c === void 0) c = "en-us"; if (!a) return c; var b; a = a.toLowerCase(); if (a in OSF.SupportedLocales) b = a; else { var d = a.split("-", 1); if (d && d.length > 0) b = OSF.AssociatedLocales[d[0]] } if (!b) b = c; return b }; var ScriptLoading; (function (e) { var a = false, b = function () { function b(g, e, d, f, c) { var b = this; b.url = g; b.isReady = e; b.hasStarted = d; b.timer = f; b.hasError = a; b.pendingCallbacks = []; b.pendingCallbacks.push(c) } return b }(), d = function () { function a(c, b, a) { this.scriptId = c; this.startTime = b; this.msResponseTime = a } return a }(), c = function () { var c = true, e = null; function f(b) { var a = this; if (b === void 0) b = { OfficeJS: "office.js", OfficeDebugJS: "office.debug.js" }; a.constantNames = b; a.defaultScriptLoadingTimeout = 1e4; a.loadedScriptByIds = {}; a.scriptTelemetryBuffer = []; a.osfControlAppCorrelationId = ""; a.basePath = e } f.prototype.isScriptLoading = function (a) { return !!(this.loadedScriptByIds[a] && this.loadedScriptByIds[a].hasStarted) }; f.prototype.getOfficeJsBasePath = function () { var a = this; if (a.basePath) return a.basePath; else { for (var g = function (b, c) { var d, a, e; e = b.toLowerCase(); a = e.indexOf(c); if (a >= 0 && a === b.length - c.length && (a === 0 || b.charAt(a - 1) === "/" || b.charAt(a - 1) === "\\")) d = b.substring(0, a); else if (a >= 0 && a < b.length - c.length && b.charAt(a + c.length) === "?" && (a === 0 || b.charAt(a - 1) === "/" || b.charAt(a - 1) === "\\")) d = b.substring(0, a); return d }, d = document.getElementsByTagName("script"), h = d.length, e = [a.constantNames.OfficeJS, a.constantNames.OfficeDebugJS], f = e.length, c, b = 0; !a.basePath && b < h; b++)if (d[b].src) for (c = 0; !a.basePath && c < f; c++)a.basePath = g(d[b].src, e[c]); return a.basePath } }; f.prototype.loadScript = function (e, d, c, a, b) { this.loadScriptInternal(e, d, c, a, b) }; f.prototype.loadScriptParallel = function (d, c, b) { this.loadScriptInternal(d, c, e, a, b) }; f.prototype.waitForFunction = function (g, e, h, i) { var b = h, f, d = function () { b--; if (g()) { e(c); return } else if (b > 0) { f = window.setTimeout(d, i); b-- } else { window.clearTimeout(f); e(a) } }; d() }; f.prototype.waitForScripts = function (b, e) { var f = this; if (this.invokeCallbackIfScriptsReady(b, e) == a) for (var c = 0; c < b.length; c++) { var g = b[c], d = this.loadedScriptByIds[g]; d && d.pendingCallbacks.push(function () { f.invokeCallbackIfScriptsReady(b, e) }) } }; f.prototype.logScriptLoading = function (c, a, b) { a = Math.floor(a); if (OSF.AppTelemetry && OSF.AppTelemetry.onScriptDone) if (OSF.AppTelemetry.onScriptDone.length == 3) OSF.AppTelemetry.onScriptDone(c, a, b); else OSF.AppTelemetry.onScriptDone(c, a, b, this.osfControlAppCorrelationId); else { var e = new d(c, a, b); this.scriptTelemetryBuffer.push(e) } }; f.prototype.setAppCorrelationId = function (a) { this.osfControlAppCorrelationId = a }; f.prototype.invokeCallbackIfScriptsReady = function (h, j) { for (var g = a, f = 0; f < h.length; f++) { var i = h[f], d = this.loadedScriptByIds[i]; if (!d) { d = new b("", a, a, e, e); this.loadedScriptByIds[i] = d } if (d.isReady == a) return a; else if (d.hasError) g = c } j(!g); return c }; f.prototype.getScriptEntryByUrl = function (c) { for (var b in this.loadedScriptByIds) { var a = this.loadedScriptByIds[b]; if (this.loadedScriptByIds.hasOwnProperty(b) && a.url === c) return a } return e }; f.prototype.loadScriptInternal = function (h, g, i, n, k) { var j = this; if (h) { var q = j, r = window.document, d = g && j.loadedScriptByIds[g] ? j.loadedScriptByIds[g] : j.getScriptEntryByUrl(h); if (!d || d.hasError || d.url.toLowerCase() != h.toLowerCase()) { var f = r.createElement("script"); f.type = "text/javascript"; if (g) f.id = g; if (!d) { d = new b(h, a, a, e, e); j.loadedScriptByIds[g ? g : h] = d } else { d.url = h; d.hasError = a; d.isReady = a } if (i) if (n) d.pendingCallbacks.unshift(i); else d.pendingCallbacks.push(i); var l = -1; if (window.performance && window.performance.now) l = window.performance.now(); var s = (new Date).getTime(), o = function (b) { if (g) { var a = (new Date).getTime() - s; if (!b) a = -a; q.logScriptLoading(g, l, a) } q.flushTelemetryBuffer() }, m = function () { var b = "undefined"; if (OSF._OfficeAppFactory.getHostInfo().hostType == "onenote" && typeof OSF.AppTelemetry !== b && typeof OSF.AppTelemetry.enableTelemetry !== b) OSF.AppTelemetry.enableTelemetry = a; if (!OSF._OfficeAppFactory.getLoggingAllowed() && typeof OSF.AppTelemetry !== b) OSF.AppTelemetry.enableTelemetry = a; o(c); d.isReady = c; if (d.timer != e) { clearTimeout(d.timer); delete d.timer } for (var h = d.pendingCallbacks.length, g = 0; g < h; g++) { var f = d.pendingCallbacks.shift(); if (f) { var i = f(c); if (i === a) break } } }, p = function () { o(a); d.hasError = c; d.isReady = c; if (d.timer != e) { clearTimeout(d.timer); delete d.timer } for (var g = d.pendingCallbacks.length, f = 0; f < g; f++) { var b = d.pendingCallbacks.shift(); if (b) { var h = b(a); if (h === a) break } } }; if (f.readyState) f.onreadystatechange = function () { if (f.readyState == "loaded" || f.readyState == "complete") { f.onreadystatechange = e; m() } }; else f.onload = m; f.onerror = p; k = k || j.defaultScriptLoadingTimeout; d.timer = setTimeout(p, k); d.hasStarted = c; f.setAttribute("crossOrigin", "anonymous"); f.src = h; r.getElementsByTagName("head")[0].appendChild(f) } else if (d.isReady) i(c); else if (n) d.pendingCallbacks.unshift(i); else d.pendingCallbacks.push(i) } }; f.prototype.flushTelemetryBuffer = function () { var b = this; if (OSF.AppTelemetry && OSF.AppTelemetry.onScriptDone) { for (var c = 0; c < b.scriptTelemetryBuffer.length; c++) { var a = b.scriptTelemetryBuffer[c]; if (OSF.AppTelemetry.onScriptDone.length == 3) OSF.AppTelemetry.onScriptDone(a.scriptId, a.startTime, a.msResponseTime); else OSF.AppTelemetry.onScriptDone(a.scriptId, a.startTime, a.msResponseTime, b.osfControlAppCorrelationId) } b.scriptTelemetryBuffer = [] } }; return f }(); e.LoadScriptHelper = c })(ScriptLoading || (ScriptLoading = {})); var OfficeExt; (function (a) { var b; (function (a) { var b = function () { function a() { var a = this; a.getDiagnostics = function (b) { var a = { host: this.getHost(), version: b || this.getDefaultVersion(), platform: this.getPlatform() }; return a }; a.platformRemappings = { web: Microsoft.Office.WebExtension.PlatformType.OfficeOnline, winrt: Microsoft.Office.WebExtension.PlatformType.Universal, win32: Microsoft.Office.WebExtension.PlatformType.PC, mac: Microsoft.Office.WebExtension.PlatformType.Mac, ios: Microsoft.Office.WebExtension.PlatformType.iOS, android: Microsoft.Office.WebExtension.PlatformType.Android }; a.camelCaseMappings = { powerpoint: Microsoft.Office.WebExtension.HostType.PowerPoint, onenote: Microsoft.Office.WebExtension.HostType.OneNote }; a.hostInfo = OSF._OfficeAppFactory.getHostInfo(); a.getHost = a.getHost.bind(a); a.getPlatform = a.getPlatform.bind(a); a.getDiagnostics = a.getDiagnostics.bind(a) } a.prototype.capitalizeFirstLetter = function (a) { if (a) return a[0].toUpperCase() + a.slice(1).toLowerCase(); return a }; a.getInstance = function () { if (a.hostObj === undefined) a.hostObj = new a; return a.hostObj }; a.prototype.getPlatform = function () { var a = this; if (a.hostInfo.hostPlatform) { var b = a.hostInfo.hostPlatform.toLowerCase(); if (a.platformRemappings[b]) return a.platformRemappings[b] } return null }; a.prototype.getHost = function () { var a = this; if (a.hostInfo.hostType) { var b = a.hostInfo.hostType.toLowerCase(); if (a.camelCaseMappings[b]) return a.camelCaseMappings[b]; b = a.capitalizeFirstLetter(a.hostInfo.hostType); if (Microsoft.Office.WebExtension.HostType[b]) return Microsoft.Office.WebExtension.HostType[b] } return null }; a.prototype.getDefaultVersion = function () { if (this.getHost()) return "16.0.0000.0000"; return null }; return a }(); a.Host = b })(b = a.HostName || (a.HostName = {})) })(OfficeExt || (OfficeExt = {})); var Office; (function (d) { var a = true, b = "undefined", c = "function", e; (function (d) { var e; (function (d) { function e() { return function () { var d = null, e = "object"; "use strict"; function Q(a) { return typeof a === c || typeof a === e && a !== d } function y(a) { return typeof a === c } function T(a) { return typeof a === e && a !== d } var z; if (!Array.isArray) z = function (a) { return Object.prototype.toString.call(a) === "[object Array]" }; else z = Array.isArray; var D = z, r = 0, pb = {}.toString, jb, w, l = function (a, b) { q[r] = a; q[r + 1] = b; r += 2; if (r === 2) if (w) w(p); else u() }; function cb(a) { w = a } function lb(a) { l = a } var X = typeof window !== b ? window : undefined, C = X || {}, G = C.MutationObserver || C.WebKitMutationObserver, mb = typeof process !== b && {}.toString.call(process) === "[object process]", kb = typeof Uint8ClampedArray !== b && typeof importScripts !== b && typeof MessageChannel !== b; function eb() { var b = process.nextTick, a = process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/); if (Array.isArray(a) && a[1] === "0" && a[2] === "10") b = setImmediate; return function () { b(p) } } function O() { var a = new MessageChannel; a.port1.onmessage = p; return function () { a.port2.postMessage(0) } } function Y() { return function () { setTimeout(p, 1) } } var q = new Array(1e3); function p() { for (var a = 0; a < r; a += 2) { var b = q[a], c = q[a + 1]; b(c); q[a] = undefined; q[a + 1] = undefined } r = 0 } var u; if (mb) u = eb(); else if (kb) u = O(); else u = Y(); function o() { } var k = void 0, m = 1, j = 2, s = new B; function K() { return new TypeError("You cannot resolve a promise with itself") } function L() { return new TypeError("A promises callback cannot return that same promise.") } function ab(b) { try { return b.then } catch (a) { s.error = a; return s } } function bb(e, d, b, c) { try { e.call(d, b, c) } catch (a) { return a } } function E(c, b, d) { l(function (e) { var c = false, g = bb(d, b, function (d) { if (c) return; c = a; if (b !== d) n(e, d); else h(e, d) }, function (b) { if (c) return; c = a; f(e, b) }, "Settle: " + (e._label || " unknown promise")); if (!c && g) { c = a; f(e, g) } }, c) } function H(b, a) { if (a._state === m) h(b, a._result); else if (a._state === j) f(b, a._result); else t(a, undefined, function (a) { n(b, a) }, function (a) { f(b, a) }) } function F(b, a) { if (a.constructor === b.constructor) H(b, a); else { var c = ab(a); if (c === s) f(b, s.error); else if (c === undefined) h(b, a); else if (y(c)) E(b, a, c); else h(b, a) } } function n(a, b) { if (a === b) f(a, K()); else if (Q(b)) F(a, b); else h(a, b) } function J(a) { a._onerror && a._onerror(a._result); x(a) } function h(a, b) { if (a._state !== k) return; a._result = b; a._state = m; a._subscribers.length !== 0 && l(x, a) } function f(a, b) { if (a._state !== k) return; a._state = j; a._result = b; l(J, a) } function t(c, g, e, f) { var a = c._subscribers, b = a.length; c._onerror = d; a[b] = g; a[b + m] = e; a[b + j] = f; b === 0 && c._state && l(x, c) } function x(b) { var a = b._subscribers, f = b._state; if (a.length === 0) return; for (var e, d, g = b._result, c = 0; c < a.length; c += 3) { e = a[c]; d = a[c + f]; if (e) A(f, e, d, g); else d(g) } b._subscribers.length = 0 } function B() { this.error = d } var v = new B; function W(b, c) { try { return b(c) } catch (a) { v.error = a; return v } } function A(l, c, i, o) { var g = y(i), b, q, e, p; if (g) { b = W(i, o); if (b === v) { p = a; q = b.error; b = d } else e = a; if (c === b) { f(c, L()); return } } else { b = o; e = a } if (c._state === k) if (g && e) n(c, b); else if (p) f(c, q); else if (l === m) h(c, b); else l === j && f(c, b) } function I(a, c) { try { c(function (b) { n(a, b) }, function (b) { f(a, b) }) } catch (b) { f(a, b) } } function i(c, b) { var a = this; a._instanceConstructor = c; a.promise = new c(o); if (a._validateInput(b)) { a._input = b; a.length = b.length; a._remaining = b.length; a._init(); if (a.length === 0) h(a.promise, a._result); else { a.length = a.length || 0; a._enumerate(); a._remaining === 0 && h(a.promise, a._result) } } else f(a.promise, a._validationError()) } i.prototype._validateInput = function (a) { return D(a) }; i.prototype._validationError = function () { return new Error("Array Methods must be provided an Array") }; i.prototype._init = function () { this._result = new Array(this.length) }; var Z = i; i.prototype._enumerate = function () { for (var a = this, d = a.length, c = a.promise, e = a._input, b = 0; c._state === k && b < d; b++)a._eachEntry(e[b], b) }; i.prototype._eachEntry = function (a, c) { var b = this, e = b._instanceConstructor; if (T(a)) if (a.constructor === e && a._state !== k) { a._onerror = d; b._settledAt(a._state, c, a._result) } else b._willSettleAt(e.resolve(a), c); else { b._remaining--; b._result[c] = a } }; i.prototype._settledAt = function (d, e, c) { var a = this, b = a.promise; if (b._state === k) { a._remaining--; if (d === j) f(b, c); else a._result[e] = c } a._remaining === 0 && h(b, a._result) }; i.prototype._willSettleAt = function (c, b) { var a = this; t(c, undefined, function (c) { a._settledAt(m, b, c) }, function (c) { a._settledAt(j, b, c) }) }; function ib(a) { return (new Z(this, a)).promise } var V = ib; function db(b) { var d = this, a = new d(o); if (!D(b)) { f(a, new TypeError("You must pass an array to race.")); return a } var h = b.length; function e(b) { n(a, b) } function g(b) { f(a, b) } for (var c = 0; a._state === k && c < h; c++)t(d.resolve(b[c]), undefined, e, g); return a } var U = db; function N(a) { var b = this; if (a && typeof a === e && a.constructor === b) return a; var c = new b(o); n(c, a); return c } var M = N; function S(c) { var b = this, a = new b(o); f(a, c); return a } var P = S, gb = 0; function R() { throw new TypeError("You must pass a resolver function as the first argument to the promise constructor") } function fb() { throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.") } var hb = g; function g(b) { var a = this; a._id = gb++; a._state = undefined; a._result = undefined; a._subscribers = []; if (o !== b) { !y(b) && R(); !(a instanceof g) && fb(); I(a, b) } } g.all = V; g.race = U; g.resolve = M; g.reject = P; g._setScheduler = cb; g._setAsap = lb; g._asap = l; g.prototype = { constructor: g, then: function (d, e) { var b = this, a = b._state; if (a === m && !d || a === j && !e) return this; var c = new this.constructor(o), g = b._result; if (a) { var f = arguments[a - 1]; l(function () { A(a, c, f, g) }) } else t(b, c, d, e); return c }, "catch": function (a) { return this.then(d, a) } }; return hb }.call(this) } d.Init = e })(e = d.PromiseImpl || (d.PromiseImpl = {})) })(e = d._Internal || (d._Internal = {})); var e; (function (d) { function f() { var b = window.navigator.userAgent, c = b.indexOf("Edge/"); if (c >= 0) { b = b.substring(c + 5, b.length); if (b < "14.14393") return a; else return false } return false } function e() { if (typeof window === b && typeof Promise === c) return Promise; if (typeof window !== b && window.Promise) if (f()) return d.PromiseImpl.Init(); else return window.Promise; else return d.PromiseImpl.Init() } d.OfficePromise = e() })(e = d._Internal || (d._Internal = {})); var f = e.OfficePromise; d.Promise = f })(Office || (Office = {})); var OTel; (function (c) { var a = "telemetry/oteljs_agave.js", b = function () { function b() { } b.loaded = function () { return !(b.logger === undefined) }; b.getOtelSinkCDNLocation = function () { return OSF._OfficeAppFactory.getLoadScriptHelper().getOfficeJsBasePath() + a }; b.getMapName = function (b, a) { if (a !== undefined && b.hasOwnProperty(a)) return b[a]; return a }; b.getHost = function () { var c = OSF._OfficeAppFactory.getHostInfo()["hostType"], d = { excel: "Excel", onenote: "OneNote", outlook: "Outlook", powerpoint: "PowerPoint", project: "Project", visio: "Visio", word: "Word" }, a = b.getMapName(d, c); return a }; b.getFlavor = function () { var c = OSF._OfficeAppFactory.getHostInfo()["hostPlatform"], d = { android: "Android", ios: "iOS", mac: "Mac", universal: "Universal", web: "Web", win32: "Win32" }, a = b.getMapName(d, c); return a }; b.ensureValue = function (a, b) { if (!a) return b; return a }; b.create = function (a) { var h = { id: a.appId, assetId: a.assetId, officeJsVersion: a.officeJSVersion, hostJsVersion: a.hostJSVersion, browserToken: a.clientId, instanceId: a.appInstanceId, name: a.name, sessionId: a.sessionId }, k = oteljs.Contracts.Office.System.SDX.getFields("SDX", h), l = b.getHost(), d = b.getFlavor(), j = d === "Web" && a.hostVersion.slice(0, 2) === "0." ? "16.0.0.0" : a.hostVersion, i = { "App.Name": l, "App.Platform": d, "App.Version": j, "Session.Id": b.ensureValue(a.correlationId, "00000000-0000-0000-0000-000000000000") }, m = oteljs_agave.AgaveSink.createInstance(i), g = "Office.Extensibility.OfficeJs", f = "db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439", e = 1755, c = new oteljs.TelemetryLogger(undefined, k); c.addSink(m); c.setTenantToken(g, f, e); return c }; b.initialize = function (e) { if (!b.Enabled) { b.promises = []; return } var a = 1e3, d = function () { var a = "undefined"; if (typeof oteljs === a || typeof oteljs_agave === a) return; if (!b.loaded()) b.logger = b.create(e); b.loaded() && b.promises.forEach(function (a) { a() }) }, c = function () { Microsoft.Office.WebExtension.onReadyInternal().then(function () { return d() }) }; OSF.OUtil.loadScript(b.getOtelSinkCDNLocation(), c, a) }; b.sendTelemetryEvent = function (a) { b.onTelemetryLoaded(function () { try { b.logger.sendTelemetryEvent(a) } catch (c) { } }) }; b.onTelemetryLoaded = function (a) { if (!b.Enabled) return; if (b.loaded()) a(); else b.promises.push(a) }; b.promises = []; b.Enabled = true; return b }(); c.OTelLogger = b })(OTel || (OTel = {})); var OfficeExt; (function (b) { var a = function () { function a() { this.m_mappings = {}; this.m_onchangeHandlers = [] } a.prototype.associate = function () { var a = "[InvalidArg] Function=associate", b = this; function c(a) { typeof console !== "undefined" && console.warn && console.warn(a) } if (arguments.length == 1 && typeof arguments[0] === "object" && arguments[0]) { var g = arguments[0]; for (var i in g) b.associate(i, g[i]) } else if (arguments.length == 2) { var d = arguments[0], h = arguments[1]; if (typeof d !== "string") { c(a); return } if (typeof h !== "function") { c(a); return } var f = d.toUpperCase(); b.m_mappings[f] && c("[DuplicatedName] Function=" + d); b.m_mappings[f] = h; for (var e = 0; e < b.m_onchangeHandlers.length; e++)b.m_onchangeHandlers[e]() } else c(a) }; a.prototype.onchange = function (a) { a && this.m_onchangeHandlers.push(a) }; Object.defineProperty(a.prototype, "mappings", { "get": function () { return this.m_mappings }, enumerable: true, configurable: true }); return a }(); b.Association = a })(OfficeExt || (OfficeExt = {})); var CustomFunctionMappings = window.CustomFunctionMappings || {}, CustomFunctions; (function (a) { var b = "__delay__"; function c() { CustomFunctionMappings[b] = true } a.delayInitialization = c; a._association = new OfficeExt.Association; function d() { a._association.associate.apply(a._association, arguments); delete CustomFunctionMappings[b] } a.associate = d })(CustomFunctions || (CustomFunctions = {})); (function () { var a = OSF.ConstantNames || {}; OSF.ConstantNames = { FileVersion: "0.0.0.0", OfficeJS: "office.js", OfficeDebugJS: "office.debug.js", DefaultLocale: "en-us", LocaleStringLoadingTimeout: 5e3, MicrosoftAjaxId: "MSAJAX", OfficeStringsId: "OFFICESTRINGS", OfficeJsId: "OFFICEJS", HostFileId: "HOST", O15MappingId: "O15Mapping", OfficeStringJS: "office_strings.js", O15InitHelper: "o15apptofilemappingtable.js", SupportedLocales: OSF.SupportedLocales, AssociatedLocales: OSF.AssociatedLocales }; for (var b in a) OSF.ConstantNames[b] = a[b] })(); OSF.InitializationHelper = function (d, b, f, e, c) { var a = this; a._hostInfo = d; a._webAppState = b; a._context = f; a._settings = e; a._hostFacade = c }; OSF.InitializationHelper.prototype.saveAndSetDialogInfo = function () { }; OSF.InitializationHelper.prototype.getAppContext = function () { }; OSF.InitializationHelper.prototype.setAgaveHostCommunication = function () { }; OSF.InitializationHelper.prototype.prepareRightBeforeWebExtensionInitialize = function () { }; OSF.InitializationHelper.prototype.loadAppSpecificScriptAndCreateOM = function () { }; OSF.InitializationHelper.prototype.prepareRightAfterWebExtensionInitialize = function () { }; OSF.HostInfoFlags = { SharedApp: 1, CustomFunction: 2 }; OSF._OfficeAppFactory = function () { var m = "_host_Info", c = "undefined", g = "function", f = "", d = true, e = false, a = null, o = function (b, a) { if (a && b && !a[b]) a[b] = {} }; o("Office", window); o("Microsoft", window); o("Office", Microsoft); o("WebExtension", Microsoft.Office); if (typeof window.Office === "object") for (var s in window.Office) if (window.Office.hasOwnProperty(s)) Microsoft.Office.WebExtension[s] = window.Office[s]; window.Office = Microsoft.Office.WebExtension; var y = { 0: "Unknown", 1: "Hidden", 2: "Taskpane", 3: "Dialog" }; Microsoft.Office.WebExtension.PlatformType = { PC: "PC", OfficeOnline: "OfficeOnline", Mac: "Mac", iOS: "iOS", Android: "Android", Universal: "Universal" }; Microsoft.Office.WebExtension.HostType = { Word: "Word", Excel: "Excel", PowerPoint: "PowerPoint", Outlook: "Outlook", OneNote: "OneNote", Project: "Project", Access: "Access", Visio: "Visio" }; var r = {}, H = {}, q = {}, j = { id: a, webAppUrl: a, conversationID: a, clientEndPoint: a, wnd: window.parent, focused: e }, b = { isO15: d, isRichClient: d, hostType: f, hostPlatform: f, hostSpecificFileVersion: f, hostLocale: f, osfControlAppCorrelationId: f, isDialog: e, disableLogging: e, flags: 0 }, l = d, i = {}, w = a, v = e, n = [], u = e, k = { host: a, platform: a, addin: a }, h = new ScriptLoading.LoadScriptHelper({ OfficeJS: OSF.ConstantNames.OfficeJS, OfficeDebugJS: OSF.ConstantNames.OfficeDebugJS }); window.performance && window.performance.now && h.logScriptLoading(OSF.ConstantNames.OfficeJsId, -1, window.performance.now()); var B = window.location.hash, A = window.location.search, x = window.name, t = function (a) { var e = a.host, b = a.platform, c = a.addin; v = d; k = { host: e, platform: b, addin: c }; while (n.length > 0) n.shift()(k) }; Microsoft.Office.WebExtension.FeatureGates = {}; Microsoft.Office.WebExtension.sendTelemetryEvent = function (a) { OTel.OTelLogger.sendTelemetryEvent(a) }; Microsoft.Office.WebExtension.onReadyInternal = function (a) { if (v) { var e = k.host, c = k.platform, d = k.addin; if (a) { var b = a({ host: e, platform: c, addin: d }); if (b && b.then && typeof b.then === g) return b.then(function () { return Office.Promise.resolve({ host: e, platform: c, addin: d }) }) } return Office.Promise.resolve({ host: e, platform: c, addin: d }) } if (a) return new Office.Promise(function (b) { n.push(function (d) { var c = a(d); if (c && c.then && typeof c.then === g) return c.then(function () { return b(d) }); b(d) }) }); return new Office.Promise(function (a) { n.push(a) }) }; Microsoft.Office.WebExtension.onReady = function (a) { u = d; return Microsoft.Office.WebExtension.onReadyInternal(a) }; var p = function (g) { var c, d = window.location.search; if (d) { var b = d.split(g + "="); if (b.length > 1) { var e = b[1], f = new RegExp("[&#]", "g"), a = e.split(f); if (a.length > 0) c = a[0] } } return c }, F = function (f, g) { var b = f.split("."), c = g.split("."), a; for (a in b) if (parseInt(b[a]) < parseInt(c[a])) return e; else if (parseInt(b[a]) > parseInt(c[a])) return d; return e }, D = function () { var b = "15.30.1128.0", a = window.external.GetContext().GetHostFullVersion(); return !!F(b, a) }, z = function () { l = d; try { if (b.disableLogging) { l = e; return } window.external = window.external || {}; if (typeof window.external.GetLoggingAllowed === c) l = d; else l = window.external.GetLoggingAllowed() } catch (a) { } }, E = function () { var i = "hostInfoValue", l = "isDialog", o = m, h = p(o); if (!h) try { var r = JSON.parse(x); h = r ? r["hostInfo"] : a } catch (s) { } if (!h) try { window.external = window.external || {}; if (typeof agaveHost !== c && agaveHost.GetHostInfo) window.external.GetHostInfo = function () { return agaveHost.GetHostInfo() }; var k = window.external.GetHostInfo(); if (k == l) { b.isO15 = d; b.isDialog = d } else if (k.toLowerCase().indexOf("mac") !== -1 && k.toLowerCase().indexOf("outlook") !== -1 && D()) b.isO15 = d; else { var q = k.split(o + "="); if (q.length > 1) h = q[1]; else h = k } } catch (s) { } var u = function () { var b = a; try { if (window.sessionStorage) b = window.sessionStorage } catch (c) { } return b }, j = u(); if (!h && j && j.getItem(i)) h = j.getItem(i); if (h) { h = decodeURIComponent(h); b.isO15 = e; var g = h.split("$"); if (typeof g[2] == c) g = h.split("|"); b.hostType = typeof g[0] == c ? f : g[0].toLowerCase(); b.hostPlatform = typeof g[1] == c ? f : g[1].toLowerCase(); b.hostSpecificFileVersion = typeof g[2] == c ? f : g[2].toLowerCase(); b.hostLocale = typeof g[3] == c ? f : g[3].toLowerCase(); b.osfControlAppCorrelationId = typeof g[4] == c ? f : g[4]; if (b.osfControlAppCorrelationId == "telemetry") b.osfControlAppCorrelationId = f; b.isDialog = typeof g[5] != c && g[5] == l ? d : e; b.disableLogging = typeof g[6] != c && g[6] == "disableLogging" ? d : e; b.flags = typeof g[7] === "string" && g[7].length > 0 ? parseInt(g[7]) : 0; var t = parseFloat(b.hostSpecificFileVersion), n = OSF.HostSpecificFileVersionDefault; if (OSF.HostSpecificFileVersionMap[b.hostType] && OSF.HostSpecificFileVersionMap[b.hostType][b.hostPlatform]) n = OSF.HostSpecificFileVersionMap[b.hostType][b.hostPlatform]; if (t > parseFloat(n)) b.hostSpecificFileVersion = n; if (j) try { j.setItem(i, h) } catch (v) { } } else { b.isO15 = d; b.hostLocale = p("locale") } }, C = function (b, a) { OSF.AppTelemetry && OSF.AppTelemetry.logAppCommonMessage && OSF.AppTelemetry.logAppCommonMessage("getAppContextAsync starts"); i.getAppContext(b, a) }, G = function () { E(); z(); if (b.hostPlatform == "web" && b.isDialog && window == window.top && window.opener == a) { window.open(f, "_self", f); window.close() } if ((b.flags & (OSF.HostInfoFlags.SharedApp | OSF.HostInfoFlags.CustomFunction)) !== 0) if (typeof window.Promise === c) window.Promise = window.Office.Promise; h.setAppCorrelationId(b.osfControlAppCorrelationId); var k = h.getOfficeJsBasePath(), B = e; if (!k) throw "Office Web Extension script library file name should be " + OSF.ConstantNames.OfficeJS + " or " + OSF.ConstantNames.OfficeDebugJS + "."; var l = function () { if (typeof Sys !== c && typeof Type !== c && Sys.StringBuilder && typeof Sys.StringBuilder === g && Type.registerNamespace && typeof Type.registerNamespace === g && Type.registerClass && typeof Type.registerClass === g || typeof OfficeExt !== c && OfficeExt.MsAjaxError) return d; else return e }, n = a, v = function (f) { var a = e, b = function () { if (typeof Strings == c || typeof Strings.OfficeOM == c) if (!a) { a = d; var g = k + OSF.ConstantNames.DefaultLocale + "/" + OSF.ConstantNames.OfficeStringJS; h.loadScript(g, OSF.ConstantNames.OfficeStringsId, b, d, OSF.ConstantNames.LocaleStringLoadingTimeout); return e } else throw "Neither the locale, " + f.toLowerCase() + ", provided by the host app nor the fallback locale " + OSF.ConstantNames.DefaultLocale + " are supported."; else { a = e; n = Strings.OfficeOM } }; if (!l()) { window.Type = Function; Type.registerNamespace = function (a) { window[a] = window[a] || {} }; Type.prototype.registerClass = function (a) { a = {} } } var g = k + OSF.getSupportedLocale(f, OSF.ConstantNames.DefaultLocale) + "/" + OSF.ConstantNames.OfficeStringJS; h.loadScript(g, OSF.ConstantNames.OfficeStringsId, b, d, OSF.ConstantNames.LocaleStringLoadingTimeout) }, o = function (s) { if (s) { i = new OSF.InitializationHelper(b, j, r, H, q); b.hostPlatform == "web" && i.saveAndSetDialogInfo && i.saveAndSetDialogInfo(p(m)); i.setAgaveHostCommunication(); C(j.wnd, function (c) { OSF.AppTelemetry && OSF.AppTelemetry.logAppCommonMessage && OSF.AppTelemetry.logAppCommonMessage("getAppContextAsync callback start"); w = c._appInstanceId; if (c.get_featureGates) { var d = c.get_featureGates(); if (d) Microsoft.Office.WebExtension.FeatureGates = d } var e = function () { var a = b.hostSpecificFileVersion.split("."); if (c.get_appMinorVersion) { var d = b.hostPlatform == "ios"; if (!d) if (isNaN(c.get_appMinorVersion())) c._appMinorVersion = parseInt(a[1]); else if (a.length > 1 && !isNaN(Number(a[1]))) c._appMinorVersion = parseInt(a[1]) } if (b.isDialog) c._isDialog = b.isDialog }; e(); var f = function () { i.prepareApiSurface && i.prepareApiSurface(c); h.waitForFunction(function () { return Microsoft.Office.WebExtension.initialize != undefined || u }, function (f) { if (f) { if (i.prepareApiSurface) Microsoft.Office.WebExtension.initialize && Microsoft.Office.WebExtension.initialize(i.getInitializationReason(c)); else { if (!Microsoft.Office.WebExtension.initialize) Microsoft.Office.WebExtension.initialize = function () { }; i.prepareRightBeforeWebExtensionInitialize(c) } i.prepareRightAfterWebExtensionInitialize && i.prepareRightAfterWebExtensionInitialize(); var e = c.get_appName(), d = a; if ((b.flags & OSF.HostInfoFlags.SharedApp) !== 0) d = { visibilityMode: y[c.get_initialDisplayMode && typeof c.get_initialDisplayMode === g ? c.get_initialDisplayMode() : 0] }; t({ host: OfficeExt.HostName.Host.getInstance().getHost(e), platform: OfficeExt.HostName.Host.getInstance().getPlatform(e), addin: d }) } else throw new Error('Office.js has not fully loaded. Your app must call "Office.onReady()" as part of it\'s loading sequence (or set the "Office.initialize" function). If your app has this functionality, try reloading this page.') }, 400, 50) }; !h.isScriptLoading(OSF.ConstantNames.OfficeStringsId) && v(c.get_appUILocale()); h.waitForScripts([OSF.ConstantNames.OfficeStringsId], function () { if (n && !Strings.OfficeOM) Strings.OfficeOM = n; i.loadAppSpecificScriptAndCreateOM(c, f, k) }) }); if (b.isO15) { var o = OSF.OUtil.parseXdmInfo() == a; if (o) { var f = d; if (window.external && typeof window.external.GetContext !== c) try { window.external.GetContext(); f = e } catch (x) { } f && t({ host: a, platform: a, addin: a }) } } } else { var l = "MicrosoftAjax.js is not loaded successfully."; OSF.AppTelemetry && OSF.AppTelemetry.logAppException && OSF.AppTelemetry.logAppException(l); throw l } }, x = function () { OSF.AppTelemetry && OSF.AppTelemetry.setOsfControlAppCorrelationId && OSF.AppTelemetry.setOsfControlAppCorrelationId(b.osfControlAppCorrelationId); if (h.isScriptLoading(OSF.ConstantNames.MicrosoftAjaxId)) h.waitForScripts([OSF.ConstantNames.MicrosoftAjaxId], o); else h.waitForFunction(l, o, 500, 100) }; if (b.isO15) h.loadScript(k + OSF.ConstantNames.O15InitHelper, OSF.ConstantNames.O15MappingId, x); else { var s = [b.hostType, b.hostPlatform, b.hostSpecificFileVersion, OSF.ConstantNames.HostFileScriptSuffix || a].filter(function (b) { return b != a }).join("-") + ".js"; h.loadScript(k + s.toLowerCase(), OSF.ConstantNames.HostFileId, x); if (typeof OSFPerformance !== c) OSFPerformance.hostSpecificFileName = s } b.hostLocale && v(b.hostLocale); if (B && !l()) { var D = (window.location.protocol.toLowerCase() === "https:" ? "https:" : "http:") + "//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js"; h.loadScriptParallel(D, OSF.ConstantNames.MicrosoftAjaxId) } window.confirm = function () { throw new Error("Function window.confirm is not supported.") }; window.alert = function () { throw new Error("Function window.alert is not supported.") }; window.prompt = function () { throw new Error("Function window.prompt is not supported.") }; var A = b.hostType == "outlook" && b.hostPlatform == "android"; if (!A) { window.history.replaceState = a; window.history.pushState = a } }; G(); return { getId: function () { return j.id }, getClientEndPoint: function () { return j.clientEndPoint }, getContext: function () { return r }, setContext: function (a) { r = a }, getHostInfo: function () { return b }, getLoggingAllowed: function () { return l }, getHostFacade: function () { return q }, setHostFacade: function (a) { q = a }, getInitializationHelper: function () { return i }, getCachedSessionSettingsKey: function () { return (j.conversationID != a ? j.conversationID : w) + "CachedSessionSettings" }, getWebAppState: function () { return j }, getWindowLocationHash: function () { return B }, getWindowLocationSearch: function () { return A }, getLoadScriptHelper: function () { return h }, getWindowName: function () { return x } } }()



var oteljs = function (e) { var t = {}; function n(r) { if (t[r]) return t[r].exports; var i = t[r] = { i: r, l: !1, exports: {} }; return e[r].call(i.exports, i, i.exports, n), i.l = !0, i.exports } return n.m = e, n.c = t, n.d = function (e, t, r) { n.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: r }) }, n.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, n.t = function (e, t) { if (1 & t && (e = n(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var r = Object.create(null); if (n.r(r), Object.defineProperty(r, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) n.d(r, i, function (t) { return e[t] }.bind(null, i)); return r }, n.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return n.d(t, "a", t), t }, n.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, n.p = "", n(n.s = 0) }([function (e, t, n) { e.exports = n(1) }, function (e, t, n) { "use strict"; var r, i, o, a, s, u, c, l, f, d; function p(e, t) { return { name: e, dataType: r.Boolean, value: t } } function v(e, t) { return { name: e, dataType: r.Int64, value: t } } function y(e, t) { return { name: e, dataType: r.Double, value: t } } function h(e, t) { return { name: e, dataType: r.String, value: t } } function g(e, t) { return { name: e, dataType: r.Guid, value: t } } function m(e, t, n) { var r = n.map((function (t) { return { name: e + "." + t.name, value: t.value, dataType: t.dataType } })); return T(r, e, t), r } function T(e, t, n) { e.push(h("zC." + t, n)) } n.r(t), function (e) { e[e.String = 0] = "String", e[e.Boolean = 1] = "Boolean", e[e.Int64 = 2] = "Int64", e[e.Double = 3] = "Double", e[e.Guid = 4] = "Guid" }(r || (r = {})), (i || (i = {})).getFields = function (e, t) { var n = []; return n.push(v(e + ".Code", t.code)), void 0 !== t.type && n.push(h(e + ".Type", t.type)), void 0 !== t.tag && n.push(v(e + ".Tag", t.tag)), void 0 !== t.isExpected && n.push(p(e + ".IsExpected", t.isExpected)), T(n, e, "Office.System.Result"), n }, (a = o || (o = {})).contractName = "Office.System.Activity", a.getFields = function (e) { var t = []; return void 0 !== e.cV && t.push(h("Activity.CV", e.cV)), t.push(v("Activity.Duration", e.duration)), t.push(v("Activity.Count", e.count)), t.push(v("Activity.AggMode", e.aggMode)), void 0 !== e.success && t.push(p("Activity.Success", e.success)), void 0 !== e.result && t.push.apply(t, i.getFields("Activity.Result", e.result)), T(t, "Activity", a.contractName), t }, (s || (s = {})).getFields = function (e, t) { var n = []; return void 0 !== t.id && n.push(h(e + ".Id", t.id)), void 0 !== t.version && n.push(h(e + ".Version", t.version)), void 0 !== t.sessionId && n.push(h(e + ".SessionId", t.sessionId)), T(n, e, "Office.System.Host"), n }, (u || (u = {})).getFields = function (e, t) { var n = []; return void 0 !== t.alias && n.push(h(e + ".Alias", t.alias)), void 0 !== t.primaryIdentityHash && n.push(h(e + ".PrimaryIdentityHash", t.primaryIdentityHash)), void 0 !== t.primaryIdentitySpace && n.push(h(e + ".PrimaryIdentitySpace", t.primaryIdentitySpace)), void 0 !== t.tenantId && n.push(h(e + ".TenantId", t.tenantId)), void 0 !== t.tenantGroup && n.push(h(e + ".TenantGroup", t.tenantGroup)), void 0 !== t.isAnonymous && n.push(p(e + ".IsAnonymous", t.isAnonymous)), T(n, e, "Office.System.User"), n }, (c || (c = {})).getFields = function (e, t) { var n = []; return void 0 !== t.id && n.push(h(e + ".Id", t.id)), void 0 !== t.version && n.push(h(e + ".Version", t.version)), void 0 !== t.instanceId && n.push(h(e + ".InstanceId", t.instanceId)), void 0 !== t.name && n.push(h(e + ".Name", t.name)), void 0 !== t.marketplaceType && n.push(h(e + ".MarketplaceType", t.marketplaceType)), void 0 !== t.sessionId && n.push(h(e + ".SessionId", t.sessionId)), void 0 !== t.browserToken && n.push(h(e + ".BrowserToken", t.browserToken)), void 0 !== t.osfRuntimeVersion && n.push(h(e + ".OsfRuntimeVersion", t.osfRuntimeVersion)), void 0 !== t.officeJsVersion && n.push(h(e + ".OfficeJsVersion", t.officeJsVersion)), void 0 !== t.hostJsVersion && n.push(h(e + ".HostJsVersion", t.hostJsVersion)), void 0 !== t.assetId && n.push(h(e + ".AssetId", t.assetId)), void 0 !== t.providerName && n.push(h(e + ".ProviderName", t.providerName)), void 0 !== t.type && n.push(h(e + ".Type", t.type)), T(n, e, "Office.System.SDX"), n }, (l || (l = {})).getFields = function (e, t) { var n = []; return void 0 !== t.name && n.push(h(e + ".Name", t.name)), void 0 !== t.state && n.push(h(e + ".State", t.state)), T(n, e, "Office.System.Funnel"), n }, (f || (f = {})).getFields = function (e, t) { var n = []; return void 0 !== t.id && n.push(v(e + ".Id", t.id)), void 0 !== t.name && n.push(h(e + ".Name", t.name)), void 0 !== t.commandSurface && n.push(h(e + ".CommandSurface", t.commandSurface)), void 0 !== t.parentName && n.push(h(e + ".ParentName", t.parentName)), void 0 !== t.triggerMethod && n.push(h(e + ".TriggerMethod", t.triggerMethod)), void 0 !== t.timeOffsetMs && n.push(v(e + ".TimeOffsetMs", t.timeOffsetMs)), T(n, e, "Office.System.UserAction"), n }, function (e) { e.getFields = function (e, t) { var n = []; return n.push(h(e + ".ErrorGroup", t.errorGroup)), n.push(v(e + ".Tag", t.tag)), void 0 !== t.code && n.push(v(e + ".Code", t.code)), void 0 !== t.id && n.push(v(e + ".Id", t.id)), void 0 !== t.count && n.push(v(e + ".Count", t.count)), T(n, e, "Office.System.Error"), n } }(d || (d = {})); var S, F, b = o, w = i, C = d, E = l, N = s, A = c, I = f, k = u; !function (e) { !function (e) { !function (e) { e.Activity = b, e.Result = w, e.Error = C, e.Funnel = E, e.Host = N, e.SDX = A, e.User = k, e.UserAction = I }(e.System || (e.System = {})) }(e.Office || (e.Office = {})) }(S || (S = {})), function (e) { var t, n = 0; e.getNext = function () { return void 0 === t && (t = function () { for (var e = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", t = [], n = 0; n < 22; n++)t.push(e.charAt(Math.floor(Math.random() * e.length))); return t.join("") }()), new r(t, ++n) }, e.getNextChild = function (e) { return new r(e.getString(), ++e.nextChild) }; var r = function () { function e(e, t) { this.base = e, this.id = t, this.nextChild = 0 } return e.prototype.getString = function () { return this.base + "." + this.id }, e }(); e.CV = r }(F || (F = {})); var x, _, O = function () { function e() { this._listeners = [] } return e.prototype.fireEvent = function (e) { this._listeners.forEach((function (t) { return t(e) })) }, e.prototype.addListener = function (e) { e && this._listeners.push(e) }, e.prototype.removeListener = function (e) { this._listeners = this._listeners.filter((function (t) { return t !== e })) }, e.prototype.getListenerCount = function () { return this._listeners.length }, e }(), P = new O; function D() { return P } function M(e, t, n) { P.fireEvent({ level: e, category: t, message: n }) } function j(e, t, n) { M(x.Error, e, (function () { var e = n instanceof Error ? n.message : ""; return t + ": " + e })) } !function (e) { e[e.Error = 0] = "Error", e[e.Warning = 1] = "Warning", e[e.Info = 2] = "Info", e[e.Verbose = 3] = "Verbose" }(x || (x = {})), function (e) { e[e.Core = 0] = "Core", e[e.Sink = 1] = "Sink", e[e.Transport = 2] = "Transport" }(_ || (_ = {})); var V = function (e, t, n, r) { return new (n || (n = Promise))((function (i, o) { function a(e) { try { u(r.next(e)) } catch (e) { o(e) } } function s(e) { try { u(r.throw(e)) } catch (e) { o(e) } } function u(e) { var t; e.done ? i(e.value) : (t = e.value, t instanceof n ? t : new n((function (e) { e(t) }))).then(a, s) } u((r = r.apply(e, t || [])).next()) })) }, L = function (e, t) { var n, r, i, o, a = { label: 0, sent: function () { if (1 & i[0]) throw i[1]; return i[1] }, trys: [], ops: [] }; return o = { next: s(0), throw: s(1), return: s(2) }, "function" == typeof Symbol && (o[Symbol.iterator] = function () { return this }), o; function s(o) { return function (s) { return function (o) { if (n) throw new TypeError("Generator is already executing."); for (; a;)try { if (n = 1, r && (i = 2 & o[0] ? r.return : o[0] ? r.throw || ((i = r.return) && i.call(r), 0) : r.next) && !(i = i.call(r, o[1])).done) return i; switch (r = 0, i && (o = [2 & o[0], i.value]), o[0]) { case 0: case 1: i = o; break; case 4: return a.label++, { value: o[1], done: !1 }; case 5: a.label++, r = o[1], o = [0]; continue; case 7: o = a.ops.pop(), a.trys.pop(); continue; default: if (!(i = (i = a.trys).length > 0 && i[i.length - 1]) && (6 === o[0] || 2 === o[0])) { a = 0; continue } if (3 === o[0] && (!i || o[1] > i[0] && o[1] < i[3])) { a.label = o[1]; break } if (6 === o[0] && a.label < i[1]) { a.label = i[1], i = o; break } if (i && a.label < i[2]) { a.label = i[2], a.ops.push(o); break } i[2] && a.ops.pop(), a.trys.pop(); continue }o = t.call(e, a) } catch (e) { o = [6, e], r = 0 } finally { n = i = 0 } if (5 & o[0]) throw o[1]; return { value: o[0] ? o[1] : void 0, done: !0 } }([o, s]) } } }, U = function () { return 1e3 * Date.now() }; "object" == typeof window.performance && "now" in window.performance && (U = function () { return 1e3 * Math.floor(window.performance.now()) }); var G, H, B, R, J, z, W, Z, X, $ = function () { function e(e, t, n) { this._optionalEventFlags = {}, this._ended = !1, this._telemetryLogger = e, this._activityName = t, this._cv = n ? F.getNextChild(n._cv) : F.getNext(), this._dataFields = [], this._success = void 0, this._startTime = U() } return e.createNew = function (t, n) { return new e(t, n) }, e.prototype.createChildActivity = function (t) { return new e(this._telemetryLogger, t, this) }, e.prototype.setEventFlags = function (e) { this._optionalEventFlags = e }, e.prototype.addDataField = function (e) { this._dataFields.push(e) }, e.prototype.addDataFields = function (e) { var t; (t = this._dataFields).push.apply(t, e) }, e.prototype.setSuccess = function (e) { this._success = e }, e.prototype.setResult = function (e, t, n) { this._result = { code: e, type: t, tag: n } }, e.prototype.endNow = function () { if (!this._ended) { void 0 === this._success && void 0 === this._result && M(x.Warning, _.Core, (function () { return "Activity does not have success or result set" })); var e = U() - this._startTime; this._ended = !0; var t = { duration: e, count: 1, aggMode: 0, cV: this._cv.getString(), success: this._success, result: this._result }; return this._telemetryLogger.sendActivity(this._activityName, t, this._dataFields, this._optionalEventFlags) } M(x.Error, _.Core, (function () { return "Activity has already ended" })) }, e.prototype.executeAsync = function (e) { return V(this, void 0, void 0, (function () { var t = this; return L(this, (function (n) { return [2, e(this).then((function (e) { return t.endNow(), e })).catch((function (e) { throw t.endNow(), e }))] })) })) }, e.prototype.executeSync = function (e) { try { var t = e(this); return this.endNow(), t } catch (e) { throw this.endNow(), e } }, e.prototype.executeChildActivityAsync = function (e, t) { return V(this, void 0, void 0, (function () { return L(this, (function (n) { return [2, this.createChildActivity(e).executeAsync(t)] })) })) }, e.prototype.executeChildActivitySync = function (e, t) { return this.createChildActivity(e).executeSync(t) }, e }(); function q(e) { var t = { costPriority: R.Normal, samplingPolicy: H.Measure, persistencePriority: B.Normal, dataCategories: J.NotSet, diagnosticLevel: z.FullEvent }; return e.eventFlags && e.eventFlags.dataCategories || M(x.Error, _.Core, (function () { return "Event is missing DataCategories event flag" })), e.eventFlags ? (e.eventFlags.costPriority && (t.costPriority = e.eventFlags.costPriority), e.eventFlags.samplingPolicy && (t.samplingPolicy = e.eventFlags.samplingPolicy), e.eventFlags.persistencePriority && (t.persistencePriority = e.eventFlags.persistencePriority), e.eventFlags.dataCategories && (t.dataCategories = e.eventFlags.dataCategories), e.eventFlags.diagnosticLevel && (t.diagnosticLevel = e.eventFlags.diagnosticLevel), t) : t } !function (e) { e[e.EssentialServiceMetadata = 1] = "EssentialServiceMetadata", e[e.AccountData = 2] = "AccountData", e[e.SystemMetadata = 4] = "SystemMetadata", e[e.OrganizationIdentifiableInformation = 8] = "OrganizationIdentifiableInformation", e[e.EndUserIdentifiableInformation = 16] = "EndUserIdentifiableInformation", e[e.CustomerContent = 32] = "CustomerContent", e[e.AccessControl = 64] = "AccessControl" }(G || (G = {})), function (e) { e[e.NotSet = 0] = "NotSet", e[e.Measure = 1] = "Measure", e[e.Diagnostics = 2] = "Diagnostics", e[e.CriticalBusinessImpact = 191] = "CriticalBusinessImpact", e[e.CriticalCensus = 192] = "CriticalCensus", e[e.CriticalExperimentation = 193] = "CriticalExperimentation", e[e.CriticalUsage = 194] = "CriticalUsage" }(H || (H = {})), function (e) { e[e.NotSet = 0] = "NotSet", e[e.Normal = 1] = "Normal", e[e.High = 2] = "High" }(B || (B = {})), function (e) { e[e.NotSet = 0] = "NotSet", e[e.Normal = 1] = "Normal", e[e.High = 2] = "High" }(R || (R = {})), function (e) { e[e.NotSet = 0] = "NotSet", e[e.SoftwareSetup = 1] = "SoftwareSetup", e[e.ProductServiceUsage = 2] = "ProductServiceUsage", e[e.ProductServicePerformance = 4] = "ProductServicePerformance", e[e.DeviceConfiguration = 8] = "DeviceConfiguration", e[e.InkingTypingSpeech = 16] = "InkingTypingSpeech" }(J || (J = {})), function (e) { e[e.ReservedDoNotUse = 0] = "ReservedDoNotUse", e[e.BasicEvent = 10] = "BasicEvent", e[e.FullEvent = 100] = "FullEvent", e[e.NecessaryServiceDataEvent = 110] = "NecessaryServiceDataEvent", e[e.AlwaysOnNecessaryServiceDataEvent = 120] = "AlwaysOnNecessaryServiceDataEvent" }(z || (z = {})), function (e) { e[e.Aria = 0] = "Aria", e[e.Nexus = 1] = "Nexus" }(W || (W = {})), function (e) { var t = {}, n = {}, r = {}; function i(e) { if ("object" != typeof e) throw new Error("tokenTree must be an object"); r = function e(t, n) { if ("object" != typeof n) return n; for (var r = 0, i = Object.keys(n); r < i.length; r++) { var o = i[r]; o in t && (t[o], 1) ? t[o] = e(t[o], n[o]) : t[o] = n[o] } return t }(r, e) } function o(e) { if (t[e]) return t[e]; var n = s(e, W.Aria); return "string" == typeof n ? (t[e] = n, n) : void 0 } function a(e) { if (n[e]) return n[e]; var t = s(e, W.Nexus); return "number" == typeof t ? (n[e] = t, t) : void 0 } function s(e, t) { var n = e.split("."), i = r, o = void 0; if (i) { for (var a = 0; a < n.length - 1; a++)i[n[a]] && (i = i[n[a]], t === W.Aria && "string" == typeof i.ariaTenantToken ? o = i.ariaTenantToken : t === W.Nexus && "number" == typeof i.nexusTenantToken && (o = i.nexusTenantToken)); return o } } e.setTenantToken = function (e, t, n) { var r = e.split("."); if (r.length < 2 || "Office" !== r[0]) M(x.Error, _.Core, (function () { return "Invalid namespace: " + e })); else { var o = Object.create(Object.prototype); t && (o.ariaTenantToken = t), n && (o.nexusTenantToken = n); var a, s = o; for (a = r.length - 1; a >= 0; --a) { var u = Object.create(Object.prototype); u[r[a]] = s, s = u } i(s) } }, e.setTenantTokens = i, e.getTenantTokens = function (e) { var t = o(e), n = a(e); if (!n || !t) throw new Error("Could not find tenant token for " + e); return { ariaTenantToken: t, nexusTenantToken: n } }, e.getAriaTenantToken = o, e.getNexusTenantToken = a, e.clear = function () { t = {}, n = {}, r = {} } }(Z || (Z = {})), function (e) { var t = /^[A-Z][a-zA-Z0-9]*$/, n = /^[a-zA-Z0-9_\.]*$/; function i(e) { return void 0 !== e && n.test(e) } function o(e) { if (!((t = e.name) && i(t) && t.length + 5 < 100)) throw new Error("Invalid dataField name"); var t; e.dataType === r.Int64 && a(e.value) } function a(e) { if ("number" != typeof e || !isFinite(e) || Math.floor(e) !== e || e < -9007199254740991 || e > 9007199254740991) throw new Error("Invalid integer " + JSON.stringify(e)) } e.validateTelemetryEvent = function (e) { if (!function (e) { if (!e || e.length > 98) return !1; var n = e.split("."), r = n[n.length - 1]; return function (e) { return !!e && e.length >= 3 && "Office" === e[0] }(n) && (i = r, void 0 !== i && t.test(i)); var i }(e.eventName)) throw new Error("Invalid eventName"); if (e.eventContract && !i(e.eventContract.name)) throw new Error("Invalid eventContract"); if (null != e.dataFields) for (var n = 0; n < e.dataFields.length; n++)o(e.dataFields[n]) }, e.validateInt = a }(X || (X = {})); var K, Q = function () { return (Q = Object.assign || function (e) { for (var t, n = 1, r = arguments.length; n < r; n++)for (var i in t = arguments[n]) Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i]); return e }).apply(this, arguments) }, Y = function () { function e(e, t, n) { var r, i; this.onSendEvent = new O, this.persistentDataFields = [], this.config = n || {}, e ? (this.onSendEvent = e.onSendEvent, (r = this.persistentDataFields).push.apply(r, e.persistentDataFields), this.config = Q(Q({}, e.getConfig()), this.config)) : this.persistentDataFields.push(h("OTelJS.Version", "3.1.36")), t && (i = this.persistentDataFields).push.apply(i, t) } return e.prototype.sendTelemetryEvent = function (e) { var t; try { if (0 === this.onSendEvent.getListenerCount()) return void M(x.Warning, _.Core, (function () { return "No telemetry sinks are attached." })); t = this.cloneEvent(e), this.processTelemetryEvent(t) } catch (e) { return void j(_.Core, "SendTelemetryEvent", e) } try { this.onSendEvent.fireEvent(t) } catch (e) { } }, e.prototype.processTelemetryEvent = function (e) { var t; e.telemetryProperties || (e.telemetryProperties = Z.getTenantTokens(e.eventName)), e.dataFields && this.persistentDataFields && (t = e.dataFields).push.apply(t, this.persistentDataFields), this.config.disableValidation || X.validateTelemetryEvent(e) }, e.prototype.addSink = function (e) { this.onSendEvent.addListener((function (t) { return e.sendTelemetryEvent(t) })) }, e.prototype.setTenantToken = function (e, t, n) { Z.setTenantToken(e, t, n) }, e.prototype.setTenantTokens = function (e) { Z.setTenantTokens(e) }, e.prototype.cloneEvent = function (e) { var t = { eventName: e.eventName, eventFlags: e.eventFlags }; return e.telemetryProperties && (t.telemetryProperties = { ariaTenantToken: e.telemetryProperties.ariaTenantToken, nexusTenantToken: e.telemetryProperties.nexusTenantToken }), e.eventContract && (t.eventContract = { name: e.eventContract.name, dataFields: e.eventContract.dataFields.slice() }), t.dataFields = e.dataFields ? e.dataFields.slice() : [], t }, e.prototype.getConfig = function () { return this.config }, e }(), ee = (K = function (e, t) { return (K = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) })(e, t) }, function (e, t) { function n() { this.constructor = e } K(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }), te = function (e, t, n, r) { return new (n || (n = Promise))((function (i, o) { function a(e) { try { u(r.next(e)) } catch (e) { o(e) } } function s(e) { try { u(r.throw(e)) } catch (e) { o(e) } } function u(e) { var t; e.done ? i(e.value) : (t = e.value, t instanceof n ? t : new n((function (e) { e(t) }))).then(a, s) } u((r = r.apply(e, t || [])).next()) })) }, ne = function (e, t) { var n, r, i, o, a = { label: 0, sent: function () { if (1 & i[0]) throw i[1]; return i[1] }, trys: [], ops: [] }; return o = { next: s(0), throw: s(1), return: s(2) }, "function" == typeof Symbol && (o[Symbol.iterator] = function () { return this }), o; function s(o) { return function (s) { return function (o) { if (n) throw new TypeError("Generator is already executing."); for (; a;)try { if (n = 1, r && (i = 2 & o[0] ? r.return : o[0] ? r.throw || ((i = r.return) && i.call(r), 0) : r.next) && !(i = i.call(r, o[1])).done) return i; switch (r = 0, i && (o = [2 & o[0], i.value]), o[0]) { case 0: case 1: i = o; break; case 4: return a.label++, { value: o[1], done: !1 }; case 5: a.label++, r = o[1], o = [0]; continue; case 7: o = a.ops.pop(), a.trys.pop(); continue; default: if (!(i = (i = a.trys).length > 0 && i[i.length - 1]) && (6 === o[0] || 2 === o[0])) { a = 0; continue } if (3 === o[0] && (!i || o[1] > i[0] && o[1] < i[3])) { a.label = o[1]; break } if (6 === o[0] && a.label < i[1]) { a.label = i[1], i = o; break } if (i && a.label < i[2]) { a.label = i[2], a.ops.push(o); break } i[2] && a.ops.pop(), a.trys.pop(); continue }o = t.call(e, a) } catch (e) { o = [6, e], r = 0 } finally { n = i = 0 } if (5 & o[0]) throw o[1]; return { value: o[0] ? o[1] : void 0, done: !0 } }([o, s]) } } }, re = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return ee(t, e), t.prototype.executeActivityAsync = function (e, t) { return te(this, void 0, void 0, (function () { return ne(this, (function (n) { return [2, this.createNewActivity(e).executeAsync(t)] })) })) }, t.prototype.executeActivitySync = function (e, t) { return this.createNewActivity(e).executeSync(t) }, t.prototype.createNewActivity = function (e) { return $.createNew(this, e) }, t.prototype.sendActivity = function (e, t, n, r) { return this.sendTelemetryEvent({ eventName: e, eventContract: { name: S.Office.System.Activity.contractName, dataFields: S.Office.System.Activity.getFields(t) }, dataFields: n, eventFlags: r }) }, t.prototype.sendError = function (e) { var t = d.getFields("Error", e.error); return null != e.dataFields && t.push.apply(t, e.dataFields), this.sendTelemetryEvent({ eventName: e.eventName, dataFields: t, eventFlags: e.eventFlags }) }, t }(Y); n.d(t, "Contracts", (function () { return S })), n.d(t, "ActivityScope", (function () { return $ })), n.d(t, "getFieldsForContract", (function () { return m })), n.d(t, "addContractField", (function () { return T })), n.d(t, "DataClassification", (function () { return G })), n.d(t, "makeBooleanDataField", (function () { return p })), n.d(t, "makeInt64DataField", (function () { return v })), n.d(t, "makeDoubleDataField", (function () { return y })), n.d(t, "makeStringDataField", (function () { return h })), n.d(t, "makeGuidDataField", (function () { return g })), n.d(t, "DataFieldType", (function () { return r })), n.d(t, "getEffectiveEventFlags", (function () { return q })), n.d(t, "SamplingPolicy", (function () { return H })), n.d(t, "PersistencePriority", (function () { return B })), n.d(t, "CostPriority", (function () { return R })), n.d(t, "DataCategories", (function () { return J })), n.d(t, "DiagnosticLevel", (function () { return z })), n.d(t, "LogLevel", (function () { return x })), n.d(t, "Category", (function () { return _ })), n.d(t, "onNotification", (function () { return D })), n.d(t, "logNotification", (function () { return M })), n.d(t, "logError", (function () { return j })), n.d(t, "SuppressNexus", (function () { return -1 })), n.d(t, "SimpleTelemetryLogger", (function () { return Y })), n.d(t, "TelemetryLogger", (function () { return re })) }]);



OSFPerformance.officeExecuteEnd = OSFPerformance.now();